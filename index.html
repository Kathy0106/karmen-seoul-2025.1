<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>2025 Christmas SEOUL trip ğŸ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    }
    body{
      background:#f4f7fb;
      color:#222;
      padding-top:env(safe-area-inset-top);
    }
    .app{
      max-width:480px;
      margin:0 auto 40px;
      background:#f4f7fb;
    }

    /* â”€â”€â”€ Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .hero{
      position:relative;
      height:170px;
      overflow:hidden;
      border-bottom-left-radius:24px;
      border-bottom-right-radius:24px;
      background:#0b6b4a url('cover.jpg') center/cover no-repeat;
      color:#fff;
    }
    .hero::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(180deg,rgba(0,0,0,0.55),rgba(0,0,0,0.18));
    }
    .hero-inner{
      position:relative;
      z-index:1;
      padding:12px 16px 8px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      height:100%;
    }
    .hero-row-top{
      display:flex;
      justify-content:space-between;
      gap:8px;
      align-items:flex-start;
    }
    .hero-title{
      font-size:20px;
      font-weight:700;
      line-height:1.2;
    }
    .hero-dates{
      margin-top:4px;
      font-size:13px;
      opacity:.9;
    }
    .hero-dest{
      margin-left:auto;
      text-align:right;
      font-size:11px;
    }
    .hero-dest strong{
      display:block;
      font-size:18px;
    }
    .badge-small{
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:10px;
      padding:3px 7px;
      border-radius:999px;
      background:rgba(0,0,0,0.25);
    }
    .edit-toggle{
      font-size:11px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.7);
      background:rgba(0,0,0,0.15);
      color:#fff;
      cursor:pointer;
      white-space:nowrap;
    }
    .edit-toggle.active{
      background:#ffe0eb;
      color:#c02b5b;
      border-color:#ffe0eb;
    }
    .hero-tabs{
      margin-top:10px;
      display:flex;
      gap:10px;
    }
    .hero-tab{
      flex:1;
      text-align:center;
      padding:6px 0;
      font-size:12px;
      border-radius:999px;
      border:none;
      background:rgba(255,255,255,0.18);
      color:#e1f6ec;
      cursor:pointer;
    }
    .hero-tab.active{
      background:#ffffff;
      color:#0b6b4a;
      font-weight:600;
    }

    /* â”€â”€â”€ Day pills â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .day-strip{
      margin-top:0;
      padding:0 12px;
    }
    .day-scroll{
      display:flex;
      overflow-x:auto;
      gap:8px;
      padding:6px 0 6px;
    }
    .day-pill{
      min-width:76px;
      padding:6px 8px;
      border-radius:12px;
      background:#e3f3ea;
      text-align:center;
      font-size:11px;
      color:#35524a;
      cursor:pointer;
      flex-shrink:0;
    }
    .day-pill span{display:block;}
    .day-pill .date{font-weight:600;font-size:12px;}
    .day-pill.active{
      background:#0b6b4a;
      color:#fff;
    }

    /* â”€â”€â”€ Main content â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .content{
      padding:8px 12px 24px;
    }
    .top-actions{
      display:flex;
      justify-content:flex-end;
      gap:8px;
      margin-bottom:4px;
      font-size:11px;
    }
    .top-actions button{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid #c1d7cc;
      background:#ffffff;
      cursor:pointer;
      color:#0b6b4a;
    }

    /* â”€â”€â”€ Weather card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .weather-card{
      margin-top:4px;
      background:#fff;
      border-radius:16px;
      padding:12px 12px 10px;
      display:flex;
      align-items:center;
      box-shadow:0 4px 10px rgba(0,0,0,0.04);
      gap:10px;
    }
    .weather-icon{
      width:40px;height:40px;border-radius:50%;
      background:#eaf6ff;
      display:flex;align-items:center;justify-content:center;
      font-size:22px;
    }
    .weather-main{flex:1;}
    .temp-row{font-size:20px;font-weight:700;}
    .temp-low{font-size:12px;margin-left:4px;color:#777;}
    .feel{font-size:11px;color:#777;margin-top:2px;}
    .weather-note{
      font-size:11px;
      color:#555;
      text-align:right;
      min-width:100px;
    }
    .weather-note strong{display:block;font-size:12px;}
    .weather-btn{
      margin-top:4px;
      font-size:10px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid #c6ddff;
      background:#f5f7ff;
      color:#3557ff;
      cursor:pointer;
    }

    /* â”€â”€â”€ Itinerary cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .section-title{
      margin:14px 4px 6px;
      font-size:13px;
      font-weight:600;
      color:#444;
    }

    .card{
      background:#fff;
      border-radius:18px;
      padding:10px 12px;
      margin-bottom:10px;
      display:flex;
      gap:10px;
      box-shadow:0 3px 8px rgba(0,0,0,0.04);
      position:relative;
    }
    .card-icon-wrap{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:4px;
      width:40px;
    }
    .card-icon-circle{
      width:32px;height:32px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      color:#fff;
    }
    .card-icon-label{
      font-size:10px;
      color:#666;
      text-align:center;
    }
    .card-body{
      flex:1;
      min-width:0;
    }
    .card-title-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      margin-bottom:2px;
    }
    .card-title{
      font-size:13px;
      font-weight:600;
    }
    .card-sub{
      font-size:11px;
      color:#666;
    }
    .card-meta{
      font-size:11px;
      color:#777;
      margin-top:2px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .meta-pill{
      background:#f3f6fb;
      border-radius:999px;
      padding:1px 7px;
      font-size:10px;
    }
    .card-note{
      font-size:11px;
      color:#555;
      margin-top:4px;
      white-space:pre-wrap;
    }
    .card-footer{
      display:flex;
      justify-content:flex-end;
      gap:4px;
      margin-top:6px;
    }
    .icon-btn{
      border:none;
      background:#f3f6fb;
      border-radius:50%;
      width:24px;
      height:24px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:13px;
      cursor:pointer;
      color:#555;
    }
    .icon-btn.primary{
      background:#0b6b4a;
      color:#fff;
    }
    .move-time{
      font-size:10px;
      color:#999;
      margin:2px 0 6px 52px;
    }

    /* â”€â”€â”€ Generic table / panels â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .table{
      width:100%;
      border-collapse:collapse;
      font-size:12px;
      background:#fff;
      border-radius:14px;
      overflow:hidden;
      box-shadow:0 3px 8px rgba(0,0,0,0.03);
    }
    .table th,
    .table td{
      padding:6px 6px;
      border-bottom:1px solid #eef1fb;
    }
    .table th{
      background:#f5f7ff;
      font-weight:600;
    }
    .table input{
      width:100%;
      border-radius:6px;
      border:1px solid #dde3f0;
      padding:3px 4px;
      font-size:11px;
    }
    .table-actions{
      margin-top:8px;
      display:flex;
      gap:8px;
      justify-content:flex-end;
    }
    .btn-pill{
      font-size:11px;
      padding:5px 10px;
      border-radius:999px;
      border:none;
      cursor:pointer;
    }
    .btn-secondary{
      background:#fff;
      border:1px solid #c1d7cc;
      color:#0b6b4a;
    }
    .btn-primary{
      background:#0b6b4a;
      color:#fff;
    }
    .del-btn{
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid #f2b2bd;
      background:#fff1f3;
      color:#e06276;
      cursor:pointer;
    }
    .total-row{
      margin-top:6px;
      font-size:12px;
      text-align:right;
      color:#444;
    }

    /* â”€â”€â”€ Info / FX / hotel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .info-card{
      background:#fff;
      border-radius:18px;
      padding:10px 12px;
      margin-bottom:10px;
      box-shadow:0 3px 8px rgba(0,0,0,0.04);
    }
    .info-title{
      font-size:13px;
      font-weight:600;
      margin-bottom:6px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .info-row{
      display:flex;
      align-items:center;
      gap:6px;
      margin-bottom:6px;
      font-size:12px;
    }
    .info-row label{
      min-width:70px;
      color:#666;
      font-size:11px;
    }
    .info-row input{
      flex:1;
      font-size:12px;
      padding:4px 6px;
      border-radius:8px;
      border:1px solid #dde3f0;
    }

    /* â”€â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:20;
    }
    .modal{
      width:90%;
      max-width:420px;
      max-height:80%;
      overflow-y:auto;
      background:#f6f8fb;
      border-radius:18px;
      box-shadow:0 16px 32px rgba(0,0,0,0.25);
      padding:14px;
    }
    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
    }
    .modal-header h2{
      font-size:16px;
    }
    .modal-body{
      font-size:12px;
    }
    .form-row{
      margin-bottom:8px;
    }
    .form-row label{
      display:block;
      font-size:11px;
      color:#555;
      margin-bottom:2px;
    }
    .form-row input,
    .form-row textarea,
    .form-row select{
      width:100%;
      font-size:12px;
      padding:5px 7px;
      border-radius:8px;
      border:1px solid #dde3f0;
      resize:vertical;
    }
    .form-row textarea{
      min-height:60px;
    }
    .modal-footer{
      display:flex;
      justify-content:space-between;
      gap:8px;
      margin-top:10px;
    }
    .btn-danger{
      background:#ff5b7a;
      color:#fff;
    }
    .btn-ghost{
      background:#ffffff;
      color:#555;
      border:1px solid #dde3f0;
    }

    .small-note{
      font-size:11px;
      color:#777;
      margin-top:6px;
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="hero">
      <div class="hero-inner">
        <div class="hero-row-top">
          <div>
            <div class="badge-small">ğŸ„ Christmas Seoul</div>
            <div class="hero-title">2025 Christmas SEOUL trip</div>
            <div class="hero-dates">2025.12.25 â€“ 12.29</div>
          </div>
          <div class="hero-dest">
            <div>ç›®çš„åœ°</div>
            <strong>Seoul</strong>
          </div>
          <button id="editToggle" class="edit-toggle">âœï¸ ç·¨è¼¯è¡Œç¨‹</button>
        </div>
        <div class="hero-tabs">
          <button class="hero-tab active" id="tab-itinerary">ğŸ—º è¡Œç¨‹</button>
          <button class="hero-tab" id="tab-expense">ğŸ’° æ¶ˆè²»</button>
          <button class="hero-tab" id="tab-flight">âœˆï¸ èˆªç­</button>
          <button class="hero-tab" id="tab-info">â„¹ï¸ è³‡è¨Š</button>
        </div>
      </div>
    </header>

    <div class="day-strip" id="dayStrip"></div>

    <main class="content">
      <div class="top-actions">
        <button id="btnWeatherAll">â„ï¸ æ›´æ–°å³æ™‚å¤©æ°£</button>
        <button id="btnPrint">ğŸ–¨ åŒ¯å‡º / PDF</button>
      </div>
      <section id="panel-itinerary"></section>
      <section id="panel-expense" style="display:none;"></section>
      <section id="panel-flight" style="display:none;"></section>
      <section id="panel-info" style="display:none;"></section>
    </main>
  </div>

  <!-- è¡Œç¨‹ç·¨è¼¯ Modal -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <h2>ç·¨è¼¯è¡Œç¨‹</h2>
        <button id="btnModalClose" class="icon-btn">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="form-row">
          <label>é¡åˆ¥</label>
          <select id="fType">
            <option value="transport">äº¤é€š</option>
            <option value="flight">èˆªç­</option>
            <option value="food">é¤å»³ / é£²é£Ÿ</option>
            <option value="sight">æ™¯é» / æ´»å‹•</option>
            <option value="hotel">ä½å®¿</option>
            <option value="shopping">è³¼ç‰©</option>
            <option value="other">å…¶ä»–</option>
          </select>
        </div>
        <div class="form-row">
          <label>é¡¯ç¤º iconï¼ˆemojiï¼‰</label>
          <input id="fIcon" placeholder="ä¾‹å¦‚ ğŸš‡ / ğŸ½ / ğŸ¨ / âœˆï¸">
        </div>
        <div class="form-row">
          <label>æ™‚é–“ï¼ˆä¾‹ï¼š~14:30 / æ—©ä¸Šï¼‰</label>
          <input id="fTime">
        </div>
        <div class="form-row">
          <label>æ¨™é¡Œï¼ˆåº—å / è¡Œç¨‹ï¼‰</label>
          <input id="fTitle">
        </div>
        <div class="form-row">
          <label>åœ°é» / ç°¡çŸ­èªªæ˜</label>
          <input id="fLocation" placeholder="ä¾‹ï¼šå¼˜å¤§å…¥å£ç«™ 9 è™Ÿå‡ºå£">
        </div>
        <div class="form-row">
          <label>ç‡Ÿæ¥­æ™‚é–“ / ç§»å‹•æ™‚é–“</label>
          <input id="fBizTime" placeholder="ä¾‹ï¼š17:00â€“20:30 / è»Šç¨‹ 60â€“80 åˆ†é˜">
        </div>
        <div class="form-row">
          <label>é–€ç¥¨ / è²»ç”¨</label>
          <input id="fFee" placeholder="ä¾‹ï¼šç´„ â‚©14,000 / äºº">
        </div>
        <div class="form-row">
          <label>å‚™è¨»</label>
          <textarea id="fNote" placeholder="å¯«å¤šå•²ç´°ç¯€ã€æ’éšŠæ™‚é–“ã€å°è²¼å£«â€¦"></textarea>
        </div>
        <div class="form-row">
          <label>åœ°åœ–é€£çµï¼ˆNaver / Googleï¼‰</label>
          <input id="fMap" placeholder="https://naver.me/...">
        </div>
        <div class="form-row">
          <label>ä¸Šä¸€é …è‡³å‘¢é …çš„ç§»å‹•æ™‚é–“ï¼ˆåˆ†é˜ï¼Œå¯ç•™ç©ºï¼‰</label>
          <input id="fMove" placeholder="ä¾‹ï¼š10ï¼ˆä»£è¡¨ 10 minï¼‰">
        </div>
      </div>
      <div class="modal-footer">
        <button id="btnModalDelete" class="btn-pill btn-danger">åˆªé™¤</button>
        <div style="flex:1;"></div>
        <button id="btnModalCancel" class="btn-pill btn-ghost">å–æ¶ˆ</button>
        <button id="btnModalSave" class="btn-pill btn-primary">å„²å­˜ä¿®æ”¹</button>
      </div>
    </div>
  </div>

  <script>
    /* ====== åŸºæœ¬è¨­å®š ====== */
    const API_KEY = "bd5e378503939ddaee76f12ad7a97608";
    const STORAGE_KEY = "seoul_trip_christmas_v3";

    const typeColors = {
      transport:"#ffa64d",
      flight:"#4da6ff",
      food:"#ff5b7a",
      sight:"#7e5bff",
      hotel:"#5cce9d",
      shopping:"#ffb74d",
      other:"#94a3b8"
    };

    /* ====== åˆå§‹è¡Œç¨‹è³‡æ–™ ====== */
    const baseTrip = { /* ï¼ï¼ï¼ï¼ï¼ï¼ä½ çš„ baseTrip å…§å®¹å®Œå…¨ç…§èˆŠï¼ï¼ï¼ï¼ï¼ï¼ */ };
  </script>
  <!-- ç”±æ–¼è¨Šæ¯é•·åº¦é™åˆ¶ï¼ŒbaseTrip åˆ°ä¸‹é¢é‚è¼¯æˆ‘å†‡æ”¹ä»»ä½•å…§å®¹ï¼Œ
       ä½ å¯ä»¥ç›´æ¥ä¿ç•™ä½ è²¼å‡ºä¾†å—°ä¸€å¤§æ®µ baseTripï¼Œæ“ºè¿”å…¥å‘¢åº¦ { } ä¹‹å…§ï¼Œ
       è·Ÿä½ç”¨ä¸‹é¢é€™æ®µ JS è¦†è“‹åŸæœ¬çš„å°±å¯ä»¥ã€‚ -->
  <script>
    /* ====== ä»¥ä¸‹é–‹å§‹ä¿‚é‚è¼¯éƒ¨åˆ†ï¼ˆå·²ä¿®å¥½ emoji & bugï¼‰ ====== */

    let trip;
    try{
      const stored = JSON.parse(localStorage.getItem(STORAGE_KEY) || "null");
      trip = stored || baseTrip;
    }catch(e){ trip = baseTrip; }

    function saveAll(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(trip)); }

    const dayStrip = document.getElementById('dayStrip');
    const itineraryPanel = document.getElementById('panel-itinerary');
    const expensePanel = document.getElementById('panel-expense');
    const flightPanel = document.getElementById('panel-flight');
    const infoPanel = document.getElementById('panel-info');

    const tabIt = document.getElementById('tab-itinerary');
    const tabEx = document.getElementById('tab-expense');
    const tabFl = document.getElementById('tab-flight');
    const tabInfo = document.getElementById('tab-info');
    const editToggleBtn = document.getElementById('editToggle');
    const printBtn = document.getElementById('btnPrint');
    const weatherAllBtn = document.getElementById('btnWeatherAll');

    const modalBackdrop = document.getElementById('modalBackdrop');
    const btnModalClose = document.getElementById('btnModalClose');
    const btnModalCancel = document.getElementById('btnModalCancel');
    const btnModalSave = document.getElementById('btnModalSave');
    const btnModalDelete = document.getElementById('btnModalDelete');

    const fType = document.getElementById('fType');
    const fIcon = document.getElementById('fIcon');
    const fTime = document.getElementById('fTime');
    const fTitle = document.getElementById('fTitle');
    const fLocation = document.getElementById('fLocation');
    const fBizTime = document.getElementById('fBizTime');
    const fFee = document.getElementById('fFee');
    const fNote = document.getElementById('fNote');
    const fMap = document.getElementById('fMap');
    const fMove = document.getElementById('fMove');

    let currentDayIndex = 0;
    let editMode = false;
    let editingDayIndex = null;
    let editingBlockIndex = null;

    function getTypeColor(t){ return typeColors[t] || typeColors.other; }

    /* ====== Day pills ====== */
    function renderDayPills(){
      const wrap = document.createElement('div');
      wrap.className = 'day-scroll';
      trip.days.forEach((d,i)=>{
        const pill = document.createElement('div');
        pill.className = 'day-pill'+(i===currentDayIndex?' active':'');
        pill.dataset.index = i;
        pill.innerHTML = `<span class="date">${d.labelShort}</span><span>${d.weekday}</span>`;
        pill.addEventListener('click',()=>{
          currentDayIndex = i;
          document.querySelectorAll('.day-pill').forEach(p=>p.classList.remove('active'));
          pill.classList.add('active');
          renderItinerary();
        });
        wrap.appendChild(pill);
      });
      dayStrip.innerHTML = '';
      dayStrip.appendChild(wrap);
    }

    /* ====== Modal æ§åˆ¶ ====== */
    function openModal(dayIndex, blockIndex){ /* â€¦â€¦ ä½ åŸæœ¬ modal å…§å®¹ç…§èˆŠ â€¦â€¦ */ }
    function closeModal(){ /* â€¦â€¦ */ }

    /* ====== å–å¾—å¤©æ°£ ====== */
    async function fetchWeatherForDay(index){
      const d = trip.days[index];
      const cityQuery = (d.city || "Seoul") + ",KR";
      try{
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(cityQuery)}&units=metric&lang=zh_tw&appid=${API_KEY}`;
        const res = await fetch(url);
        if(!res.ok) throw new Error("HTTP "+res.status);
        const data = await res.json();

        const w0 = data.weather && data.weather[0] ? data.weather[0] : null;

        d.weather.temp = Math.round(data.main.temp).toString();
        d.weather.low  = Math.round(data.main.temp_min).toString();
        d.weather.feel = Math.round(data.main.feels_like).toString();
        d.weather.text = w0 ? (w0.description || "") : "";

        d.weather.id    = w0 ? w0.id   : null;
        d.weather.main  = w0 ? w0.main : "";
        d.weather.icon  = w0 ? w0.icon : "";

        saveAll();
      }catch(e){
        console.error(e);
        alert("å–å¾—å¤©æ°£å¤±æ•—ï¼Œå¯ä»¥ä¹‹å¾Œå†è©¦ä¸€æ¬¡ã€‚");
      }
    }

    async function updateAllWeather(){
      for(let i=0;i<trip.days.length;i++){
        await fetchWeatherForDay(i);
      }
      renderItinerary();
      alert("å·²æ›´æ–°é¦–çˆ¾å³æ™‚å¤©æ°£ï¼ˆæ‰€æœ‰æ—¥å­é¡¯ç¤ºåŒä¸€åˆ»å¤©æ°£ï¼‰âœ…");
    }

    function labelType(t){
      switch(t){
        case "transport":return "äº¤é€š";
        case "flight":return "èˆªç­";
        case "food":return "é£²é£Ÿ";
        case "sight":return "æ™¯é»";
        case "hotel":return "ä½å®¿";
        case "shopping":return "è³¼ç‰©";
        default:return "å…¶ä»–";
      }
    }

    // â­ æ ¹æ“š OpenWeather å¤©æ°£è³‡æ–™æ±ºå®š emoji
    function getWeatherEmoji(w){
      const id = w && w.id ? w.id : 0;
      const main = (w && w.main ? w.main : "").toLowerCase();
      const text = (w && w.text ? w.text : "").toLowerCase();

      if(id >= 200 && id < 300) return "â›ˆï¸";
      if(id >= 300 && id < 600) return "ğŸŒ§ï¸";
      if(id >= 600 && id < 700) return "â„ï¸";
      if(id >= 700 && id < 800) return "ğŸŒ«ï¸";
      if(id === 800)             return "â˜€ï¸";
      if(id > 800 && id < 900)   return "â˜ï¸";

      if(main.includes("thunder")) return "â›ˆï¸";
      if(main.includes("rain") || text.includes("é›¨")) return "ğŸŒ§ï¸";
      if(main.includes("snow") || text.includes("é›ª")) return "â„ï¸";
      if(main.includes("cloud")) return "â˜ï¸";
      if(main.includes("clear")) return "â˜€ï¸";

      return "ğŸŒ¤";
    }

    /* ====== è¡Œç¨‹æ¸²æŸ“ï¼ˆå·²ä¿® emojiï¼‰ ====== */
    function renderItinerary(){
      const d = trip.days[currentDayIndex];
      const w = d.weather;
      const emoji = getWeatherEmoji(w);   // â­ ä¹‹å‰å†‡å‘¢è¡Œ â†’ æœƒå ±éŒ¯

      itineraryPanel.innerHTML = '';

      const weather = document.createElement('div');
      weather.className = 'weather-card';
      weather.innerHTML = `
        <div class="weather-icon">${emoji}</div>
        <div class="weather-main">
          <div style="font-size:11px;color:#777;margin-bottom:2px;">
            å³æ™‚é¦–çˆ¾å¤©æ°£ï¼ˆéè¡Œç¨‹æ—¥æœŸé å ±ï¼‰
          </div>
          <div class="temp-row">
            ${w.temp ? w.temp+"Â°C" : "--"}
            <span class="temp-low">${w.low ? "/ "+w.low+"Â°C" : ""}</span>
          </div>
          <div class="feel">
            ${w.feel ? "é«”æ„Ÿ "+w.feel+"Â°C ãƒ» " : ""}${w.text || "é¦–æ¬¡ä½¿ç”¨å¯æŒ‰ä¸‹é¢æŒ‰éˆ•æ›´æ–°é¦–çˆ¾å³æ™‚å¤©æ°£ã€‚"}
          </div>
          <button class="weather-btn" id="btnWeatherOne">
            â†» æ›´æ–°å³æ™‚å¤©æ°£ï¼ˆæ­¤æ—¥é¡¯ç¤ºï¼‰
          </button>
        </div>
        <div class="weather-note">
          <strong>ä»Šæ—¥é‡é»</strong>
          <span>${w.note || ""}</span>
        </div>
      `;
      itineraryPanel.appendChild(weather);

      // â€¦â€¦ ä¸‹é¢ block cards æ¸²æŸ“ã€hintã€btnWeatherOne.onclick ç­‰ï¼Œå…¨ä¿ç•™åŸæœ¬å…§å®¹ â€¦â€¦
    }

    /* ====== å…¶é¤˜éƒ¨åˆ†ï¼ˆcardFooterHandler / renderExpenses / renderFlights / renderInfo / initï¼‰ ====== */
    // â€¦â€¦ å…¨éƒ¨ç…§ç”¨ä½ åŸæœ¬çš„ç¨‹å¼ï¼Œåªè¦ä¿è­‰æ”¾å–ºåŒä¸€å€‹ <script> è£é¢å°±å¯ä»¥ â€¦â€¦

    function init(){
      renderDayPills();
      renderItinerary();
      renderExpenses();
      renderFlights();
      renderInfo();
      switchTab(tabIt);

      // åªç¶ä¸€æ¬¡ footer handler
      itineraryPanel.addEventListener('click', cardFooterHandler);
    }
    init();
  </script>
</body>
</html>